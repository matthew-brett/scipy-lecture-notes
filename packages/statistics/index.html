
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Statistics in Python &#8212; Scientific Python Lectures</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/exercise.css?v=982b99e0" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'packages/statistics/index';</script>
    <link rel="canonical" href="https://matthew-brett.github.io/scipy-lecture-notes/packages/statistics/index.html" />
    <link rel="icon" href="../../_static/sp_lectures.png"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Sympy : Symbolic Mathematics in Python" href="../sympy.html" />
    <link rel="prev" title="Packages and applications" href="../index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/sp_lectures.png" class="logo__image only-light" alt="Scientific Python Lectures - Home"/>
    <script>document.write(`<img src="../../_static/sp_lectures.png" class="logo__image only-dark" alt="Scientific Python Lectures - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started with Python for Science</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../intro/index.html">Getting started with Python for science</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/intro.html">Python scientific computing ecosystem</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../intro/language/python_language.html">The Python language</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../intro/language/first_steps.html">First steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/language/basic_types.html">Basic types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/language/control_flow.html">Control Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/language/functions.html">Defining functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/language/reusing_code.html">Reusing code: scripts and modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/language/io.html">Input and Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/language/standard_library.html">Standard Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/language/exceptions.html">Exception handling in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/language/oop.html">Object-oriented programming (OOP)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../intro/numpy/index.html">NumPy: creating and manipulating numerical data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../intro/numpy/array_object.html">The NumPy array object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/numpy/operations.html">Numerical operations on arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/numpy/elaborate_arrays.html">More elaborate arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/numpy/advanced_operations.html">Advanced operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/numpy/exercises.html">Some exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/matplotlib/index.html">Matplotlib: plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/scipy/index.html">SciPy : high-level scientific computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/help/help.html">Getting help and finding documentation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../advanced/index.html">Advanced topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced/advanced_python/index.html">Advanced Python Constructs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced/advanced_numpy/index.html">Advanced NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced/debugging/index.html">Debugging code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced/optimizing/index.html">Optimizing code</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../advanced/scipy_sparse/introduction.html">Introduction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/scipy_sparse/storage_schemes.html">Storage Schemes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/scipy_sparse/solvers.html">Linear System Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/scipy_sparse/other_packages.html">Other Interesting Packages</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced/image_processing/index.html">Image manipulation and processing using NumPy and SciPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced/mathematical_optimization/index.html">Mathematical optimization: finding minima of functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced/interfacing_with_c/interfacing_with_c.html">Interfacing with C</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Packages and applications</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Packages and applications</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Statistics in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sympy.html">Sympy : Symbolic Mathematics in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scikit-image/index.html"><code class="docutils literal notranslate"><span class="pre">scikit-image</span></code>: image processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scikit-learn/index.html">scikit-learn: machine learning in Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About the Scientific Python Lectures</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About the Scientific Python Lecture notes</a></li>




</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="/scipy-lecture-notes/interact/lab/index.html?path=packages/statistics/index.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch via JupyterLite"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterLite logo" src="../../_static/images/logo_jupyterlite.svg">
  </span>
<span class="btn__text-container">JupyterLite</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/matthew-brett/scipy-lecture-notes" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/matthew-brett/scipy-lecture-notes/edit/main/packages/statistics/index.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/matthew-brett/scipy-lecture-notes/issues/new?title=Issue%20on%20page%20%2Fpackages/statistics/index.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/packages/statistics/index.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../../_sources/packages/statistics/index.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Statistics in Python</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-representation-and-interaction">Data representation and interaction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-as-a-table">Data as a table</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-pandas-data-frame">The pandas data-frame</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-dataframes-reading-data-files-or-converting-arrays">Creating dataframes: reading data files or converting arrays</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulating-data">Manipulating data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-data">Plotting data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-testing-comparing-two-groups">Hypothesis testing: comparing two groups</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#student-s-t-test-the-simplest-statistical-test">Student’s t-test: the simplest statistical test</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#one-sample-tests-testing-the-value-of-a-population-mean">One-sample tests: testing the value of a population mean</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#two-sample-t-test-testing-for-difference-across-populations">Two-sample t-test: testing for difference across populations</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#paired-tests-repeated-measurements-on-the-same-individuals">Paired tests: repeated measurements on the same individuals</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-models-multiple-factors-and-analysis-of-variance">Linear models, multiple factors, and analysis of variance</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#formulas-to-specify-statistical-models-in-python">“formulas” to specify statistical models in Python</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-linear-regression">A simple linear regression</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-variables-comparing-groups-or-multiple-categories">Categorical variables: comparing groups or multiple categories</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#link-to-t-tests-between-different-fsiq-and-piq">Link to t-tests between different FSIQ and PIQ</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-regression-including-multiple-factors">Multiple Regression: including multiple factors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#post-hoc-hypothesis-testing-analysis-of-variance-anova">Post-hoc hypothesis testing: analysis of variance (ANOVA)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-visualization-seaborn-for-statistical-exploration">More visualization: Seaborn for statistical exploration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pairplot-scatter-matrices">Pairplot: scatter matrices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lmplot-plotting-a-univariate-regression">lmplot: plotting a univariate regression</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-for-interactions">Testing for interactions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="statistics-in-python">
<span id="statistics"></span><h1>Statistics in Python<a class="headerlink" href="#statistics-in-python" title="Link to this heading">#</a></h1>
<p><strong>Author</strong>: <em>Gaël Varoquaux</em></p>
<div class="admonition-requirements admonition">
<p class="admonition-title">Requirements</p>
<ul class="simple">
<li><p>Standard scientific Python environment (NumPy, SciPy, matplotlib)</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/">Pandas</a></p></li>
<li><p><a class="reference external" href="https://www.statsmodels.org/">Statsmodels</a></p></li>
<li><p><a class="reference external" href="https://seaborn.pydata.org">Seaborn</a></p></li>
</ul>
<p>To install Python and these dependencies, we recommend that you
download <a class="reference external" href="https://www.anaconda.com/distribution/">Anaconda Python</a> or,
preferably, use the package manager if you are under Ubuntu or other linux.</p>
</div>
<div class="admonition-see-also admonition">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><strong>Bayesian statistics in Python</strong>:
This chapter does not cover tools for Bayesian statistics. Of
particular interest for Bayesian modelling is <a class="reference external" href="https://docs.pymc.io/">PyMC</a>, which implements a probabilistic
programming language in Python.</p></li>
<li><p><strong>Read a statistics book</strong>:
The <a class="reference external" href="https://greenteapress.com/wp/think-stats-2e">Think stats</a> book is
available as free PDF or in print and is a great introduction to
statistics.</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition note">
<p class="admonition-title">Note</p>
<p><strong>Why Python for statistics?</strong></p>
<p>R is a language dedicated to statistics. Python is a general-purpose
language with statistics modules. R has more statistical analysis
features than Python, and specialized syntaxes. However, when it
comes to building complex analysis pipelines that mix statistics with
e.g. image analysis, text mining, or control of a physical
experiment, the richness of Python is an invaluable asset.</p>
</div>
<div class="dropdown admonition note">
<p class="admonition-title">Note</p>
<p>In this document, the Python inputs are represented with the sign
“&gt;&gt;&gt;”.</p>
<p><strong>Disclaimer: Gender questions</strong></p>
<p>Some of the examples of this tutorial are chosen around gender
questions. The reason is that on such questions controlling the truth
of a claim actually matters to many people.</p>
</div>
<section id="data-representation-and-interaction">
<h2>Data representation and interaction<a class="headerlink" href="#data-representation-and-interaction" title="Link to this heading">#</a></h2>
<section id="data-as-a-table">
<h3>Data as a table<a class="headerlink" href="#data-as-a-table" title="Link to this heading">#</a></h3>
<p>The setting that we consider for statistical analysis is that of multiple
<em>observations</em> or <em>samples</em> described by a set of different <em>attributes</em>
or <em>features</em>. The data can than be seen as a 2D table, or matrix, with
columns giving the different attributes of the data, and rows the
observations. For instance, the data contained in
<a class="reference download internal" download="" href="../../_downloads/cc48b617db83afe66c7e4e955ea3f3bd/brain_size.csv"><code class="xref download docutils literal notranslate"><span class="pre">examples/brain_size.csv</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="s2">&quot;Gender&quot;</span><span class="p">;</span><span class="s2">&quot;FSIQ&quot;</span><span class="p">;</span><span class="s2">&quot;VIQ&quot;</span><span class="p">;</span><span class="s2">&quot;PIQ&quot;</span><span class="p">;</span><span class="s2">&quot;Weight&quot;</span><span class="p">;</span><span class="s2">&quot;Height&quot;</span><span class="p">;</span><span class="s2">&quot;MRI_Count&quot;</span>
<span class="s2">&quot;1&quot;</span><span class="p">;</span><span class="s2">&quot;Female&quot;</span><span class="p">;</span><span class="mi">133</span><span class="p">;</span><span class="mi">132</span><span class="p">;</span><span class="mi">124</span><span class="p">;</span><span class="s2">&quot;118&quot;</span><span class="p">;</span><span class="s2">&quot;64.5&quot;</span><span class="p">;</span><span class="mi">816932</span>
<span class="s2">&quot;2&quot;</span><span class="p">;</span><span class="s2">&quot;Male&quot;</span><span class="p">;</span><span class="mi">140</span><span class="p">;</span><span class="mi">150</span><span class="p">;</span><span class="mi">124</span><span class="p">;</span><span class="s2">&quot;.&quot;</span><span class="p">;</span><span class="s2">&quot;72.5&quot;</span><span class="p">;</span><span class="mi">1001121</span>
<span class="s2">&quot;3&quot;</span><span class="p">;</span><span class="s2">&quot;Male&quot;</span><span class="p">;</span><span class="mi">139</span><span class="p">;</span><span class="mi">123</span><span class="p">;</span><span class="mi">150</span><span class="p">;</span><span class="s2">&quot;143&quot;</span><span class="p">;</span><span class="s2">&quot;73.3&quot;</span><span class="p">;</span><span class="mi">1038437</span>
<span class="s2">&quot;4&quot;</span><span class="p">;</span><span class="s2">&quot;Male&quot;</span><span class="p">;</span><span class="mi">133</span><span class="p">;</span><span class="mi">129</span><span class="p">;</span><span class="mi">128</span><span class="p">;</span><span class="s2">&quot;172&quot;</span><span class="p">;</span><span class="s2">&quot;68.8&quot;</span><span class="p">;</span><span class="mi">965353</span>
<span class="s2">&quot;5&quot;</span><span class="p">;</span><span class="s2">&quot;Female&quot;</span><span class="p">;</span><span class="mi">137</span><span class="p">;</span><span class="mi">132</span><span class="p">;</span><span class="mi">134</span><span class="p">;</span><span class="s2">&quot;147&quot;</span><span class="p">;</span><span class="s2">&quot;65.0&quot;</span><span class="p">;</span><span class="mi">951545</span>
</pre></div>
</div>
</section>
<section id="the-pandas-data-frame">
<h3>The pandas data-frame<a class="headerlink" href="#the-pandas-data-frame" title="Link to this heading">#</a></h3>
<div class="dropdown admonition note">
<p class="admonition-title">Note</p>
<p>We will store and manipulate this data in a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>, from
the <a class="reference external" href="https://pandas.pydata.org">pandas</a> module. It is the Python equivalent of
the spreadsheet table. It is different from a 2D <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array as it has named
columns, can contain a mixture of different data types by column, and has
elaborate selection and pivotal mechanisms.</p>
</div>
<section id="creating-dataframes-reading-data-files-or-converting-arrays">
<h4>Creating dataframes: reading data files or converting arrays<a class="headerlink" href="#creating-dataframes-reading-data-files-or-converting-arrays" title="Link to this heading">#</a></h4>
<aside class="sidebar">
<p class="sidebar-title">Separator</p>
<p>It is a CSV file, but the separator is “;”</p>
</aside>
<p><strong>Reading from a CSV file:</strong> Using the above CSV file that gives
observations of brain size and weight and IQ (Willerman et al. 1991), the
data are a mixture of numerical and categorical values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;examples/brain_size.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Gender</th>
      <th>FSIQ</th>
      <th>VIQ</th>
      <th>PIQ</th>
      <th>Weight</th>
      <th>Height</th>
      <th>MRI_Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Female</td>
      <td>133</td>
      <td>132</td>
      <td>124</td>
      <td>118.0</td>
      <td>64.5</td>
      <td>816932</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Male</td>
      <td>140</td>
      <td>150</td>
      <td>124</td>
      <td>NaN</td>
      <td>72.5</td>
      <td>1001121</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Male</td>
      <td>139</td>
      <td>123</td>
      <td>150</td>
      <td>143.0</td>
      <td>73.3</td>
      <td>1038437</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Male</td>
      <td>133</td>
      <td>129</td>
      <td>128</td>
      <td>172.0</td>
      <td>68.8</td>
      <td>965353</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Female</td>
      <td>137</td>
      <td>132</td>
      <td>134</td>
      <td>147.0</td>
      <td>65.0</td>
      <td>951545</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Female</td>
      <td>99</td>
      <td>90</td>
      <td>110</td>
      <td>146.0</td>
      <td>69.0</td>
      <td>928799</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Female</td>
      <td>138</td>
      <td>136</td>
      <td>131</td>
      <td>138.0</td>
      <td>64.5</td>
      <td>991305</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Female</td>
      <td>92</td>
      <td>90</td>
      <td>98</td>
      <td>175.0</td>
      <td>66.0</td>
      <td>854258</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Male</td>
      <td>89</td>
      <td>93</td>
      <td>84</td>
      <td>134.0</td>
      <td>66.3</td>
      <td>904858</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Male</td>
      <td>133</td>
      <td>114</td>
      <td>147</td>
      <td>172.0</td>
      <td>68.8</td>
      <td>955466</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Female</td>
      <td>132</td>
      <td>129</td>
      <td>124</td>
      <td>118.0</td>
      <td>64.5</td>
      <td>833868</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Male</td>
      <td>141</td>
      <td>150</td>
      <td>128</td>
      <td>151.0</td>
      <td>70.0</td>
      <td>1079549</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Male</td>
      <td>135</td>
      <td>129</td>
      <td>124</td>
      <td>155.0</td>
      <td>69.0</td>
      <td>924059</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Female</td>
      <td>140</td>
      <td>120</td>
      <td>147</td>
      <td>155.0</td>
      <td>70.5</td>
      <td>856472</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Female</td>
      <td>96</td>
      <td>100</td>
      <td>90</td>
      <td>146.0</td>
      <td>66.0</td>
      <td>878897</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Female</td>
      <td>83</td>
      <td>71</td>
      <td>96</td>
      <td>135.0</td>
      <td>68.0</td>
      <td>865363</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Female</td>
      <td>132</td>
      <td>132</td>
      <td>120</td>
      <td>127.0</td>
      <td>68.5</td>
      <td>852244</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Male</td>
      <td>100</td>
      <td>96</td>
      <td>102</td>
      <td>178.0</td>
      <td>73.5</td>
      <td>945088</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Female</td>
      <td>101</td>
      <td>112</td>
      <td>84</td>
      <td>136.0</td>
      <td>66.3</td>
      <td>808020</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Male</td>
      <td>80</td>
      <td>77</td>
      <td>86</td>
      <td>180.0</td>
      <td>70.0</td>
      <td>889083</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Male</td>
      <td>83</td>
      <td>83</td>
      <td>86</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>892420</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Male</td>
      <td>97</td>
      <td>107</td>
      <td>84</td>
      <td>186.0</td>
      <td>76.5</td>
      <td>905940</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Female</td>
      <td>135</td>
      <td>129</td>
      <td>134</td>
      <td>122.0</td>
      <td>62.0</td>
      <td>790619</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Male</td>
      <td>139</td>
      <td>145</td>
      <td>128</td>
      <td>132.0</td>
      <td>68.0</td>
      <td>955003</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Female</td>
      <td>91</td>
      <td>86</td>
      <td>102</td>
      <td>114.0</td>
      <td>63.0</td>
      <td>831772</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Male</td>
      <td>141</td>
      <td>145</td>
      <td>131</td>
      <td>171.0</td>
      <td>72.0</td>
      <td>935494</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Female</td>
      <td>85</td>
      <td>90</td>
      <td>84</td>
      <td>140.0</td>
      <td>68.0</td>
      <td>798612</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Male</td>
      <td>103</td>
      <td>96</td>
      <td>110</td>
      <td>187.0</td>
      <td>77.0</td>
      <td>1062462</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Female</td>
      <td>77</td>
      <td>83</td>
      <td>72</td>
      <td>106.0</td>
      <td>63.0</td>
      <td>793549</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Female</td>
      <td>130</td>
      <td>126</td>
      <td>124</td>
      <td>159.0</td>
      <td>66.5</td>
      <td>866662</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Female</td>
      <td>133</td>
      <td>126</td>
      <td>132</td>
      <td>127.0</td>
      <td>62.5</td>
      <td>857782</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Male</td>
      <td>144</td>
      <td>145</td>
      <td>137</td>
      <td>191.0</td>
      <td>67.0</td>
      <td>949589</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Male</td>
      <td>103</td>
      <td>96</td>
      <td>110</td>
      <td>192.0</td>
      <td>75.5</td>
      <td>997925</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Male</td>
      <td>90</td>
      <td>96</td>
      <td>86</td>
      <td>181.0</td>
      <td>69.0</td>
      <td>879987</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Female</td>
      <td>83</td>
      <td>90</td>
      <td>81</td>
      <td>143.0</td>
      <td>66.5</td>
      <td>834344</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Female</td>
      <td>133</td>
      <td>129</td>
      <td>128</td>
      <td>153.0</td>
      <td>66.5</td>
      <td>948066</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Male</td>
      <td>140</td>
      <td>150</td>
      <td>124</td>
      <td>144.0</td>
      <td>70.5</td>
      <td>949395</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Female</td>
      <td>88</td>
      <td>86</td>
      <td>94</td>
      <td>139.0</td>
      <td>64.5</td>
      <td>893983</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Male</td>
      <td>81</td>
      <td>90</td>
      <td>74</td>
      <td>148.0</td>
      <td>74.0</td>
      <td>930016</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Male</td>
      <td>89</td>
      <td>91</td>
      <td>89</td>
      <td>179.0</td>
      <td>75.5</td>
      <td>935863</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Missing values</strong></p>
<p>The weight of the second individual is missing in the CSV file. If we
don’t specify the missing value (NA = not available) marker, we will
not be able to do statistical analysis.</p>
</div>
<p><strong>Creating from arrays</strong>: A <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> can also be seen
as a dictionary of 1D ‘series’, eg arrays or lists. If we have 3
<code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">sin_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">cos_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can expose them as a <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span> <span class="s1">&#39;sin&#39;</span><span class="p">:</span> <span class="n">sin_t</span><span class="p">,</span> <span class="s1">&#39;cos&#39;</span><span class="p">:</span> <span class="n">cos_t</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t</th>
      <th>sin</th>
      <th>cos</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-6.000000</td>
      <td>0.279415</td>
      <td>0.960170</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-5.368421</td>
      <td>0.792419</td>
      <td>0.609977</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-4.736842</td>
      <td>0.999701</td>
      <td>0.024451</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-4.105263</td>
      <td>0.821291</td>
      <td>-0.570509</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-3.473684</td>
      <td>0.326021</td>
      <td>-0.945363</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-2.842105</td>
      <td>-0.295030</td>
      <td>-0.955488</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-2.210526</td>
      <td>-0.802257</td>
      <td>-0.596979</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-1.578947</td>
      <td>-0.999967</td>
      <td>-0.008151</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-0.947368</td>
      <td>-0.811882</td>
      <td>0.583822</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-0.315789</td>
      <td>-0.310567</td>
      <td>0.950551</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.315789</td>
      <td>0.310567</td>
      <td>0.950551</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.947368</td>
      <td>0.811882</td>
      <td>0.583822</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.578947</td>
      <td>0.999967</td>
      <td>-0.008151</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2.210526</td>
      <td>0.802257</td>
      <td>-0.596979</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2.842105</td>
      <td>0.295030</td>
      <td>-0.955488</td>
    </tr>
    <tr>
      <th>15</th>
      <td>3.473684</td>
      <td>-0.326021</td>
      <td>-0.945363</td>
    </tr>
    <tr>
      <th>16</th>
      <td>4.105263</td>
      <td>-0.821291</td>
      <td>-0.570509</td>
    </tr>
    <tr>
      <th>17</th>
      <td>4.736842</td>
      <td>-0.999701</td>
      <td>0.024451</td>
    </tr>
    <tr>
      <th>18</th>
      <td>5.368421</td>
      <td>-0.792419</td>
      <td>0.609977</td>
    </tr>
    <tr>
      <th>19</th>
      <td>6.000000</td>
      <td>-0.279415</td>
      <td>0.960170</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Other inputs</strong>: <a class="reference external" href="https://pandas.pydata.org">pandas</a> can input data from
SQL, excel files, or other formats. See the <a class="reference external" href="https://pandas.pydata.org">pandas documentation</a>.</p>
</section>
<section id="manipulating-data">
<h4>Manipulating data<a class="headerlink" href="#manipulating-data" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">data</span></code> is a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>, that resembles R’s dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>    <span class="c1"># 40 rows and 8 columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(40, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>  <span class="c1"># It has columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Gender&#39;, &#39;FSIQ&#39;, &#39;VIQ&#39;, &#39;PIQ&#39;, &#39;Weight&#39;, &#39;Height&#39;, &#39;MRI_Count&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span>  <span class="c1"># Columns can be addressed by name</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1     Female
2       Male
3       Male
4       Male
5     Female
6     Female
7     Female
8     Female
9       Male
10      Male
11    Female
12      Male
13      Male
14    Female
15    Female
16    Female
17    Female
18      Male
19    Female
20      Male
21      Male
22      Male
23    Female
24      Male
25    Female
26      Male
27    Female
28      Male
29    Female
30    Female
31    Female
32      Male
33      Male
34      Male
35    Female
36    Female
37      Male
38    Female
39      Male
40      Male
Name: Gender, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simpler selector</span>
<span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Female&#39;</span><span class="p">][</span><span class="s1">&#39;VIQ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(109.45)
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a quick view on a large dataframe, use its <code class="docutils literal notranslate"><span class="pre">describe</span></code>
method: <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.describe.html#pandas.DataFrame.describe" title="(in pandas v2.3.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.describe()</span></code></a>.</p>
</div>
<p><strong>groupby</strong>: splitting a dataframe on values of categorical variables:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">groupby_gender</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Gender&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">gender</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">groupby_gender</span><span class="p">[</span><span class="s1">&#39;VIQ&#39;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">((</span><span class="n">gender</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;Female&#39;, np.float64(109.45))
(&#39;Male&#39;, np.float64(115.25))
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">groupby_gender</span></code> is a powerful object that exposes many
operations on the resulting group of dataframes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">groupby_gender</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FSIQ</th>
      <th>VIQ</th>
      <th>PIQ</th>
      <th>Weight</th>
      <th>Height</th>
      <th>MRI_Count</th>
    </tr>
    <tr>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Female</th>
      <td>111.9</td>
      <td>109.45</td>
      <td>110.45</td>
      <td>137.200000</td>
      <td>65.765000</td>
      <td>862654.6</td>
    </tr>
    <tr>
      <th>Male</th>
      <td>115.0</td>
      <td>115.25</td>
      <td>111.60</td>
      <td>166.444444</td>
      <td>71.431579</td>
      <td>954855.4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="dropdown admonition note">
<p class="admonition-title">Note</p>
<p>Use tab-completion on <code class="docutils literal notranslate"><span class="pre">groupby_gender</span></code> to find more. Other common
grouping functions are median, count (useful for checking to see the
amount of missing values in different subsets) or sum. Groupby
evaluation is lazy, no work is done until an aggregation function is
applied.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;examples/brain_size.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

<span class="c1"># Box plots of different columns for each gender</span>
<span class="n">groupby_gender</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Gender&quot;</span><span class="p">)</span>
<span class="n">groupby_gender</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;FSIQ&quot;</span><span class="p">,</span> <span class="s2">&quot;VIQ&quot;</span><span class="p">,</span> <span class="s2">&quot;PIQ&quot;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e0708e3bbc7cd4b12c6472a2618a93fff3193250e473cc09a941c11650955234.png" src="../../_images/e0708e3bbc7cd4b12c6472a2618a93fff3193250e473cc09a941c11650955234.png" />
</div>
</div>
<div class="exercise dropdown admonition" id="stats-brain-basic">

<p class="admonition-title"><span class="caption-number">Exercise 58 </span></p>
<section id="exercise-content">
<ul>
<li><p>What is the mean value for VIQ for the full population?</p></li>
<li><p>How many males/females were included in this study?</p>
<p><strong>Hint</strong> use ‘tab completion’ to find out the methods that can be
called, instead of ‘mean’ in the above example.</p>
</li>
<li><p>What is the average value of MRI counts expressed in log units, for
males and females?</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">groupby_gender.boxplot</span></code> is used for the plots above (see the plot code
above).</p>
</div>
</section>
</div>
</section>
<section id="plotting-data">
<h4>Plotting data<a class="headerlink" href="#plotting-data" title="Link to this heading">#</a></h4>
<p>Pandas comes with some plotting tools (<code class="xref py py-mod docutils literal notranslate"><span class="pre">pandas.plotting</span></code>, using
matplotlib behind the scene) to display statistics of the data in
dataframes:</p>
<p><strong>Scatter matrices</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Weight&#39;</span><span class="p">,</span> <span class="s1">&#39;Height&#39;</span><span class="p">,</span> <span class="s1">&#39;MRI_Count&#39;</span><span class="p">]]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4065c34158c7b841415bef7482e2c9a337203b7e277934de185485def4fad65a.png" src="../../_images/4065c34158c7b841415bef7482e2c9a337203b7e277934de185485def4fad65a.png" />
</div>
</div>
<aside class="sidebar">
<p class="sidebar-title">Two populations</p>
<p>The IQ metrics are bimodal, as if there are 2 sub-populations.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;PIQ&#39;</span><span class="p">,</span> <span class="s1">&#39;VIQ&#39;</span><span class="p">,</span> <span class="s1">&#39;FSIQ&#39;</span><span class="p">]]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ba34b156f40aeee701bb697363e26e6df1b1a9975ea7be16810c78b0305d9cf5.png" src="../../_images/ba34b156f40aeee701bb697363e26e6df1b1a9975ea7be16810c78b0305d9cf5.png" />
</div>
</div>
<div class="exercise dropdown admonition" id="stats-bimodel-ex">

<p class="admonition-title"><span class="caption-number">Exercise 59 </span></p>
<section id="exercise-content">
<p>Plot the scatter matrix for males only, and for females only. Do you
think that the 2 sub-populations correspond to gender?</p>
</section>
</div>
</section>
</section>
</section>
<section id="hypothesis-testing-comparing-two-groups">
<h2>Hypothesis testing: comparing two groups<a class="headerlink" href="#hypothesis-testing-comparing-two-groups" title="Link to this heading">#</a></h2>
<p>For simple <a class="reference external" href="https://en.wikipedia.org/wiki/Statistical_hypothesis_testing">statistical tests</a>, we will
use the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.16.2)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a> sub-module of <a class="reference external" href="https://docs.scipy.org/doc/">SciPy</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition-see-also admonition">
<p class="admonition-title">See also</p>
<p>SciPy is a vast library. For a quick summary to the whole library, see
the <a class="reference internal" href="../../intro/scipy/index.html#scipy"><span class="std std-ref">scipy</span></a> chapter.</p>
</div>
<section id="student-s-t-test-the-simplest-statistical-test">
<h3>Student’s t-test: the simplest statistical test<a class="headerlink" href="#student-s-t-test-the-simplest-statistical-test" title="Link to this heading">#</a></h3>
<section id="one-sample-tests-testing-the-value-of-a-population-mean">
<h4>One-sample tests: testing the value of a population mean<a class="headerlink" href="#one-sample-tests-testing-the-value-of-a-population-mean" title="Link to this heading">#</a></h4>
<p><img alt="" src="../../_images/two_sided.png" /></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_1samp.html#scipy.stats.ttest_1samp" title="(in SciPy v1.16.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.stats.ttest_1samp()</span></code></a> tests the null hypothesis that the mean
of the population underlying the data is equal to a given value. It returns
the <a class="reference external" href="https://en.wikipedia.org/wiki/Student%27s_t-test">T statistic</a>,
and the <a class="reference external" href="https://en.wikipedia.org/wiki/P-value">p-value</a> (see the
function’s help):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;VIQ&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TtestResult(statistic=np.float64(30.08809997084933), pvalue=np.float64(1.3289196468727879e-28), df=np.int64(39))
</pre></div>
</div>
</div>
</div>
<p>The p-value of <span class="math notranslate nohighlight">\(10^-28\)</span> indicates that such an extreme value of the statistic
is unlikely to be observed under the null hypothesis. This may be taken as
evidence that the null hypothesis is false and that the population mean IQ
(VIQ measure) is not 0.</p>
<p>Technically, the p-value of the t-test is derived under the assumption that
the means of samples drawn from the population are normally distributed.
This condition is exactly satisfied when the population itself is normally
distributed; however, due to the central limit theorem, the condition is
nearly true for reasonably large samples drawn from populations that follow
a variety of non-normal distributions.</p>
<p>Nonetheless, if we are concerned that violation of the normality assumptions
will affect the conclusions of the test, we can use a <a class="reference external" href="https://en.wikipedia.org/wiki/Wilcoxon_signed-rank_test">Wilcoxon signed-rank test</a>, which relaxes
this assumption at the expense of test power:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">wilcoxon</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;VIQ&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WilcoxonResult(statistic=np.float64(0.0), pvalue=np.float64(3.488172636231201e-08))
</pre></div>
</div>
</div>
</div>
</section>
<section id="two-sample-t-test-testing-for-difference-across-populations">
<h4>Two-sample t-test: testing for difference across populations<a class="headerlink" href="#two-sample-t-test-testing-for-difference-across-populations" title="Link to this heading">#</a></h4>
<p>We have seen above that the mean VIQ in the male and female samples
were different. To test whether this difference is significant (and
suggests that there is a difference in population means), we perform
a two-sample t-test using <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_ind.html#scipy.stats.ttest_ind" title="(in SciPy v1.16.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.stats.ttest_ind()</span></code></a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">female_viq</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Female&#39;</span><span class="p">][</span><span class="s1">&#39;VIQ&#39;</span><span class="p">]</span>
<span class="n">male_viq</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Male&#39;</span><span class="p">][</span><span class="s1">&#39;VIQ&#39;</span><span class="p">]</span>
<span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">female_viq</span><span class="p">,</span> <span class="n">male_viq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TtestResult(statistic=np.float64(-0.7726161723275012), pvalue=np.float64(0.44452876778583217), df=np.float64(38.0))
</pre></div>
</div>
</div>
</div>
<p>The corresponding non-parametric test is the <a class="reference external" href="https://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U">Mann–Whitney U
test</a>,
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.mannwhitneyu.html#scipy.stats.mannwhitneyu" title="(in SciPy v1.16.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.stats.mannwhitneyu()</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">female_viq</span><span class="p">,</span> <span class="n">male_viq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MannwhitneyuResult(statistic=np.float64(164.5), pvalue=np.float64(0.3422886868727315))
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="paired-tests-repeated-measurements-on-the-same-individuals">
<h3>Paired tests: repeated measurements on the same individuals<a class="headerlink" href="#paired-tests-repeated-measurements-on-the-same-individuals" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Box plot of FSIQ and PIQ (different measures of IQ)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">data</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;FSIQ&quot;</span><span class="p">,</span> <span class="s2">&quot;PIQ&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="../../_images/0a6e025de01fd3a6033fee11d41b77b291ca1455a9c50e7e3fc56c7140e8bd04.png" src="../../_images/0a6e025de01fd3a6033fee11d41b77b291ca1455a9c50e7e3fc56c7140e8bd04.png" />
</div>
</div>
<p>PIQ, VIQ, and FSIQ give three measures of IQ. Let us test whether FISQ and PIQ
are significantly different. We can use an “independent sample” test:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FSIQ&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;PIQ&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TtestResult(statistic=np.float64(0.465637596380964), pvalue=np.float64(0.6427725009414841), df=np.float64(78.0))
</pre></div>
</div>
</div>
</div>
<p>The problem with this approach is that it ignores an important relationship
between observations: FSIQ and PIQ are measured on the same individuals. Thus,
the variance due to inter-subject variability is confounding, reducing the
power of the test. This variability can be removed using a “paired test” or
<a class="reference external" href="https://en.wikipedia.org/wiki/Repeated_measures_design">“repeated measures
test”</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_rel</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FSIQ&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;PIQ&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TtestResult(statistic=np.float64(1.7842019405859857), pvalue=np.float64(0.08217263818364236), df=np.int64(39))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Boxplot of the difference</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FSIQ&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;PIQ&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">((</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="s2">&quot;FSIQ - PIQ&quot;</span><span class="p">,));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/48667012685f44df48245157891efd40af9d59e6c7f2b12c4fa1d4694842af3e.png" src="../../_images/48667012685f44df48245157891efd40af9d59e6c7f2b12c4fa1d4694842af3e.png" />
</div>
</div>
<p>This is equivalent to a one-sample test on the differences between paired
observations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FSIQ&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;PIQ&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TtestResult(statistic=np.float64(1.7842019405859857), pvalue=np.float64(0.08217263818364236), df=np.int64(39))
</pre></div>
</div>
</div>
</div>
<p>Accordingly, we can perform a nonparametric version of the test with
<code class="docutils literal notranslate"><span class="pre">wilcoxon</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">wilcoxon</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FSIQ&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;PIQ&#39;</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;approx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WilcoxonResult(statistic=np.float64(274.5), pvalue=np.float64(0.10659492713506856))
</pre></div>
</div>
</div>
</div>
<div class="exercise dropdown admonition" id="stats-weights-ex">

<p class="admonition-title"><span class="caption-number">Exercise 60 </span></p>
<section id="exercise-content">
<ul class="simple">
<li><p>Test the difference between weights in males and females.</p></li>
<li><p>Use non parametric statistics to test the difference between VIQ in
males and females.</p></li>
</ul>
</section>
</div>
<div class="solution dropdown admonition" id="packages/statistics/index-solution-3">

<p class="admonition-title">Solution to<a class="reference internal" href="#stats-weights-ex"> Exercise 60</a></p>
<section id="solution-content">
<p><strong>Conclusion</strong>: we find that the data does not support the hypothesis
that males and females have different VIQ.</p>
</section>
</div>
</section>
</section>
<section id="linear-models-multiple-factors-and-analysis-of-variance">
<h2>Linear models, multiple factors, and analysis of variance<a class="headerlink" href="#linear-models-multiple-factors-and-analysis-of-variance" title="Link to this heading">#</a></h2>
<section id="formulas-to-specify-statistical-models-in-python">
<h3>“formulas” to specify statistical models in Python<a class="headerlink" href="#formulas-to-specify-statistical-models-in-python" title="Link to this heading">#</a></h3>
<section id="a-simple-linear-regression">
<h4>A simple linear regression<a class="headerlink" href="#a-simple-linear-regression" title="Link to this heading">#</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>From an original example by <strong>Thomas Haslwanter</strong>.</p>
</div>
<p>Given two set of observations, <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>, we want to test the
hypothesis that <code class="docutils literal notranslate"><span class="pre">y</span></code> is a linear function of <code class="docutils literal notranslate"><span class="pre">x</span></code>. In other terms:</p>
<div class="math notranslate nohighlight">
\[
y = x * \textit{coef} + \textit{intercept} + e
\]</div>
<p>where <span class="math notranslate nohighlight">\(e\)</span> is observation noise. We will use the <a class="reference external" href="https://www.statsmodels.org/">statsmodels</a> module to:</p>
<ol class="arabic simple">
<li><p>Fit a linear model. We will use the simplest strategy, <a class="reference external" href="https://en.wikipedia.org/wiki/Ordinary_least_squares">ordinary least
squares</a> (OLS).</p></li>
<li><p>Test that <code class="docutils literal notranslate"><span class="pre">coef</span></code> is non zero.</p></li>
</ol>
<p>First, we generate simulated data according to the model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># To get reproducible values, provide a seed value</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">27446968</span><span class="p">)</span>

<span class="c1"># normal distributed noise</span>
<span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Create a data frame containing all the relevant variables</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>

<span class="c1"># Plot the data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a4a9a79a93d5f488a6c6dac89fcad39ae736a5fc0dd52596d8f1a98342204c94.png" src="../../_images/a4a9a79a93d5f488a6c6dac89fcad39ae736a5fc0dd52596d8f1a98342204c94.png" />
</div>
</div>
<aside class="sidebar">
<p class="sidebar-title">“formulas” for statistics in Python</p>
<p><a class="reference external" href="https://www.statsmodels.org/stable/example_formulas.html">See the statsmodels documentation</a></p>
</aside>
<p>Then we specify an OLS model and fit it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.formula.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">smf</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;y ~ x&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We can inspect the various statistics derived from the fit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>            <td>y</td>        <th>  R-squared:         </th> <td>   0.901</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.896</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   164.5</td>
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 29 Sep 2025</td> <th>  Prob (F-statistic):</th> <td>1.72e-10</td>
</tr>
<tr>
  <th>Time:</th>                 <td>12:28:38</td>     <th>  Log-Likelihood:    </th> <td> -51.758</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    20</td>      <th>  AIC:               </th> <td>   107.5</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    18</td>      <th>  BIC:               </th> <td>   109.5</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   -4.2948</td> <td>    0.759</td> <td>   -5.661</td> <td> 0.000</td> <td>   -5.889</td> <td>   -2.701</td>
</tr>
<tr>
  <th>x</th>         <td>    3.2060</td> <td>    0.250</td> <td>   12.825</td> <td> 0.000</td> <td>    2.681</td> <td>    3.731</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 1.218</td> <th>  Durbin-Watson:     </th> <td>   1.796</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.544</td> <th>  Jarque-Bera (JB):  </th> <td>   0.999</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.503</td> <th>  Prob(JB):          </th> <td>   0.607</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.568</td> <th>  Cond. No.          </th> <td>    3.03</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<div class="admonition-terminology admonition">
<p class="admonition-title">Terminology:</p>
<p>Statsmodels uses a statistical terminology: the <code class="docutils literal notranslate"><span class="pre">y</span></code> variable in
statsmodels is called ‘endogenous’ while the <code class="docutils literal notranslate"><span class="pre">x</span></code> variable is called
exogenous. This is discussed in more detail <a class="reference external" href="https://www.statsmodels.org/devel/endog_exog.html">here</a>.</p>
<p>To simplify, <code class="docutils literal notranslate"><span class="pre">y</span></code> (endogenous) is the value you are trying to predict,
while <code class="docutils literal notranslate"><span class="pre">x</span></code> (exogenous) represents the features you are using to make
the prediction.</p>
<p>If the terminology is unfamiliar, you might be able to remember which way
round these go by noticing that there is an <code class="docutils literal notranslate"><span class="pre">x</span></code> in exogenous.</p>
</div>
<div class="exercise dropdown admonition" id="stats-estimated-params-ex">

<p class="admonition-title"><span class="caption-number">Exercise 61 </span></p>
<section id="exercise-content">
<p>Retrieve the estimated parameters from the model above.</p>
<p><strong>Hint</strong>: use tab-completion to find the relevant attribute.</p>
</section>
</div>
</section>
<section id="categorical-variables-comparing-groups-or-multiple-categories">
<h4>Categorical variables: comparing groups or multiple categories<a class="headerlink" href="#categorical-variables-comparing-groups-or-multiple-categories" title="Link to this heading">#</a></h4>
<p>Let us go back the data on brain size:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;examples/brain_size.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can write a comparison between IQ of male and female using a linear
model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;VIQ ~ Gender + 1&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>VIQ</td>       <th>  R-squared:         </th> <td>   0.015</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>  -0.010</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>  0.5969</td>
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 29 Sep 2025</td> <th>  Prob (F-statistic):</th>  <td> 0.445</td> 
</tr>
<tr>
  <th>Time:</th>                 <td>12:28:38</td>     <th>  Log-Likelihood:    </th> <td> -182.42</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    40</td>      <th>  AIC:               </th> <td>   368.8</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    38</td>      <th>  BIC:               </th> <td>   372.2</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
         <td></td>           <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>      <td>  109.4500</td> <td>    5.308</td> <td>   20.619</td> <td> 0.000</td> <td>   98.704</td> <td>  120.196</td>
</tr>
<tr>
  <th>Gender[T.Male]</th> <td>    5.8000</td> <td>    7.507</td> <td>    0.773</td> <td> 0.445</td> <td>   -9.397</td> <td>   20.997</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>26.188</td> <th>  Durbin-Watson:     </th> <td>   1.709</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>   3.703</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.010</td> <th>  Prob(JB):          </th> <td>   0.157</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 1.510</td> <th>  Cond. No.          </th> <td>    2.62</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<div class="admonition-tips-on-specifying-models admonition">
<p class="admonition-title">Tips on specifying models</p>
<p><strong>Forcing categorical</strong>: the ‘Gender’ is automatically detected as a
categorical variable, and thus each of its different values are
treated as different entities.</p>
<p>An integer column can be forced to be treated as categorical using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;VIQ ~ C(Gender)&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Intercept</strong>: We can remove the intercept using <code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">1</span></code> in the formula,
or force the use of an intercept using <code class="docutils literal notranslate"><span class="pre">+</span> <span class="pre">1</span></code>.</p>
<div class="dropdown admonition note">
<p class="admonition-title">Note</p>
<p>By default, statsmodels treats a categorical variable with K possible
values as K-1 ‘dummy’ boolean variables (the last level being
absorbed into the intercept term). This is almost always a good
default choice - however, it is possible to specify different
encodings for categorical variables
(<a class="reference external" href="https://www.statsmodels.org/devel/contrasts.html">https://www.statsmodels.org/devel/contrasts.html</a>).</p>
</div>
</div>
</section>
<section id="link-to-t-tests-between-different-fsiq-and-piq">
<h4>Link to t-tests between different FSIQ and PIQ<a class="headerlink" href="#link-to-t-tests-between-different-fsiq-and-piq" title="Link to this heading">#</a></h4>
<p>To compare different types of IQ, we need to create a “long-form”
table, listing IQs, where the type of IQ is indicated by a
categorical variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_fisq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;iq&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;FSIQ&#39;</span><span class="p">],</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;fsiq&#39;</span><span class="p">})</span>
<span class="n">data_piq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;iq&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;PIQ&#39;</span><span class="p">],</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;piq&#39;</span><span class="p">})</span>
<span class="n">data_long</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">data_fisq</span><span class="p">,</span> <span class="n">data_piq</span><span class="p">))</span>
<span class="n">data_long</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iq</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>133</td>
      <td>fsiq</td>
    </tr>
    <tr>
      <th>1</th>
      <td>140</td>
      <td>fsiq</td>
    </tr>
    <tr>
      <th>2</th>
      <td>139</td>
      <td>fsiq</td>
    </tr>
    <tr>
      <th>3</th>
      <td>133</td>
      <td>fsiq</td>
    </tr>
    <tr>
      <th>4</th>
      <td>137</td>
      <td>fsiq</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>128</td>
      <td>piq</td>
    </tr>
    <tr>
      <th>36</th>
      <td>124</td>
      <td>piq</td>
    </tr>
    <tr>
      <th>37</th>
      <td>94</td>
      <td>piq</td>
    </tr>
    <tr>
      <th>38</th>
      <td>74</td>
      <td>piq</td>
    </tr>
    <tr>
      <th>39</th>
      <td>89</td>
      <td>piq</td>
    </tr>
  </tbody>
</table>
<p>80 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;iq ~ type&quot;</span><span class="p">,</span> <span class="n">data_long</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>iq</td>        <th>  R-squared:         </th> <td>   0.003</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>  -0.010</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>  0.2168</td>
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 29 Sep 2025</td> <th>  Prob (F-statistic):</th>  <td> 0.643</td> 
</tr>
<tr>
  <th>Time:</th>                 <td>12:28:38</td>     <th>  Log-Likelihood:    </th> <td> -364.35</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    80</td>      <th>  AIC:               </th> <td>   732.7</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    78</td>      <th>  BIC:               </th> <td>   737.5</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>   <td>  113.4500</td> <td>    3.683</td> <td>   30.807</td> <td> 0.000</td> <td>  106.119</td> <td>  120.781</td>
</tr>
<tr>
  <th>type[T.piq]</th> <td>   -2.4250</td> <td>    5.208</td> <td>   -0.466</td> <td> 0.643</td> <td>  -12.793</td> <td>    7.943</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>164.598</td> <th>  Durbin-Watson:     </th> <td>   1.531</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td>   8.062</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.110</td>  <th>  Prob(JB):          </th> <td>  0.0178</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 1.461</td>  <th>  Cond. No.          </th> <td>    2.62</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<p>We can see that we retrieve the same values for t-test and
corresponding p-values for the effect of the type of iq than the
previous t-test:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FSIQ&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;PIQ&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TtestResult(statistic=np.float64(0.465637596380964), pvalue=np.float64(0.6427725009414841), df=np.float64(78.0))
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="multiple-regression-including-multiple-factors">
<h3>Multiple Regression: including multiple factors<a class="headerlink" href="#multiple-regression-including-multiple-factors" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>From an original example by <em>Thomas Haslwanter</em></p>
</div>
<p>Consider a linear model explaining a variable <code class="docutils literal notranslate"><span class="pre">z</span></code> (the dependent
variable) with 2 variables <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>:</p>
<div class="math notranslate nohighlight">
\[
z = x \, c_1 + y \, c_2 + i + e
\]</div>
<p>Such a model can be seen in 3D as fitting a plane to a cloud of (<code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>,
<code class="docutils literal notranslate"><span class="pre">z</span></code>) points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate and show the data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="c1"># We generate a 2D grid</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="c1"># To get reproducible values, provide a seed value</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">27446968</span><span class="p">)</span>

<span class="c1"># Z is the elevation of this 2D grid</span>
<span class="n">Z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">X</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Plot the data</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>
<span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">120</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/70fcaec3dcdc469fbbe3599fa84ce47a55c53944806ecd6f93c7fef4758480fb.png" src="../../_images/70fcaec3dcdc469fbbe3599fa84ce47a55c53944806ecd6f93c7fef4758480fb.png" />
</div>
</div>
<p><strong>Example: the iris data</strong> (<a class="reference download internal" download="" href="../../_downloads/6c4b367d8ba9371e9254c70abb7496c5/iris.csv"><code class="xref download docutils literal notranslate"><span class="pre">examples/iris.csv</span></code></a>)</p>
<div class="dropdown admonition note">
<p class="admonition-title">Note</p>
<p>Sepal and petal size tend to be related: bigger flowers are bigger!
But is there in addition a systematic effect of species?</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;examples/iris.csv&#39;</span><span class="p">)</span>
<span class="c1"># Express the names as categories</span>
<span class="n">categories</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
<span class="c1"># The parameter &#39;c&#39; is passed to plt.scatter and will control the color</span>
<span class="n">pd</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">categories</span><span class="o">.</span><span class="n">codes</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;blue: setosa, green: versicolor, red: virginica&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">13</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3c5b265968666049ad43b6f6acee443ecded63ae1d43512997cc6128e36ea649.png" src="../../_images/3c5b265968666049ad43b6f6acee443ecded63ae1d43512997cc6128e36ea649.png" />
</div>
</div>
<p>Let us try to explain the sepal length as a function of the petal
width and the category of iris</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;sepal_width ~ name + petal_length&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>       <td>sepal_width</td>   <th>  R-squared:         </th> <td>   0.478</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.468</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   44.63</td>
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 29 Sep 2025</td> <th>  Prob (F-statistic):</th> <td>1.58e-20</td>
</tr>
<tr>
  <th>Time:</th>                 <td>12:28:39</td>     <th>  Log-Likelihood:    </th> <td> -38.185</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   150</td>      <th>  AIC:               </th> <td>   84.37</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   146</td>      <th>  BIC:               </th> <td>   96.41</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
           <td></td>             <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>          <td>    2.9813</td> <td>    0.099</td> <td>   29.989</td> <td> 0.000</td> <td>    2.785</td> <td>    3.178</td>
</tr>
<tr>
  <th>name[T.versicolor]</th> <td>   -1.4821</td> <td>    0.181</td> <td>   -8.190</td> <td> 0.000</td> <td>   -1.840</td> <td>   -1.124</td>
</tr>
<tr>
  <th>name[T.virginica]</th>  <td>   -1.6635</td> <td>    0.256</td> <td>   -6.502</td> <td> 0.000</td> <td>   -2.169</td> <td>   -1.158</td>
</tr>
<tr>
  <th>petal_length</th>       <td>    0.2983</td> <td>    0.061</td> <td>    4.920</td> <td> 0.000</td> <td>    0.178</td> <td>    0.418</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 2.868</td> <th>  Durbin-Watson:     </th> <td>   1.753</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.238</td> <th>  Jarque-Bera (JB):  </th> <td>   2.885</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.082</td> <th>  Prob(JB):          </th> <td>   0.236</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.659</td> <th>  Cond. No.          </th> <td>    54.0</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
</section>
<section id="post-hoc-hypothesis-testing-analysis-of-variance-anova">
<h3>Post-hoc hypothesis testing: analysis of variance (ANOVA)<a class="headerlink" href="#post-hoc-hypothesis-testing-analysis-of-variance-anova" title="Link to this heading">#</a></h3>
<p>In the above iris example, we wish to test if the petal length is
different between versicolor and virginica, after removing the effect of
sepal width. This can be formulated as testing the difference between the
coefficient associated to versicolor and virginica in the linear model
estimated above (it is an Analysis of Variance, <a class="reference external" href="https://en.wikipedia.org/wiki/Analysis_of_variance">ANOVA</a>). For this, we
write a <strong>vector of ‘contrast’</strong> on the parameters estimated: we want to
test <code class="docutils literal notranslate"><span class="pre">&quot;name[T.versicolor]</span> <span class="pre">-</span> <span class="pre">name[T.virginica]&quot;</span></code>, with an <a class="reference external" href="https://en.wikipedia.org/wiki/F-test">F-test</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">f_test</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;F test: F=3.2453353465742247, p=0.07369058781700905, df_denom=146, df_num=1&gt;
</pre></div>
</div>
</div>
</div>
<p>Is this difference significant?</p>
<div class="exercise dropdown admonition" id="stats-male-female-ex">

<p class="admonition-title"><span class="caption-number">Exercise 62 </span></p>
<section id="exercise-content">
<p>Going back to the brain size + IQ data, test if the VIQ of male and
female are different after removing the effect of brain size, height
and weight.</p>
</section>
</div>
</section>
</section>
<section id="more-visualization-seaborn-for-statistical-exploration">
<h2>More visualization: Seaborn for statistical exploration<a class="headerlink" href="#more-visualization-seaborn-for-statistical-exploration" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://seaborn.pydata.org">Seaborn</a> combines
simple statistical fits with plotting on pandas dataframes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span>
</pre></div>
</div>
</div>
</div>
<p>Let us consider a data giving wages and many other personal information
on 500 individuals (<a class="reference external" href="https://lib.stat.cmu.edu/datasets/CPS_85_Wages">Berndt, ER. The Practice of Econometrics. 1991. NY:
Addison-Wesley</a>).</p>
<p>We first load and arrange the data — view the code for details:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;examples/wages.txt&quot;</span><span class="p">,</span>
    <span class="n">skiprows</span><span class="o">=</span><span class="mi">27</span><span class="p">,</span>
    <span class="n">skipfooter</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;python&quot;</span>  <span class="c1"># To allow use of skipfooter.</span>
<span class="p">)</span>
<span class="c1"># Give names to the columns</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;education: Number of years of education&quot;</span><span class="p">,</span>
    <span class="s2">&quot;south: 1=person lives in South, 0=Person lives elsewhere&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sex: 1=female, 0=Male&quot;</span><span class="p">,</span>
    <span class="s2">&quot;experience: Number of years of work experience&quot;</span><span class="p">,</span>
    <span class="s2">&quot;union: 1=union member, 0=Not union member&quot;</span><span class="p">,</span>
    <span class="s2">&quot;wage: wage (dollars per hour)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;age: years&quot;</span><span class="p">,</span>
    <span class="s2">&quot;race: 1=other, 2=Hispanic, 3=White&quot;</span><span class="p">,</span>
    <span class="s2">&quot;occupation: 1=Management, 2=Sales, 3=Clerical, 4=Service, 5=Professional, 6=Other&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sector: 0=Other, 1=Manufacturing, 2=Construction&quot;</span><span class="p">,</span>
    <span class="s2">&quot;marr: 0=unmarried,  1=Married&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">short_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">short_names</span><span class="p">)</span>
<span class="c1"># Log-transform the wages, because they typically are increased with</span>
<span class="c1"># multiplicative factors</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;wage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;wage&quot;</span><span class="p">])</span>
<span class="c1"># Convert genders to strings (this is particularly useful so that the</span>
<span class="c1"># statsmodels formulas detects that `sex` is a categorical variable)</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;sex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">choose</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;male&quot;</span><span class="p">,</span> <span class="s2">&quot;female&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Here are the resulting loaded data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>education</th>
      <th>south</th>
      <th>sex</th>
      <th>experience</th>
      <th>union</th>
      <th>wage</th>
      <th>age</th>
      <th>race</th>
      <th>occupation</th>
      <th>sector</th>
      <th>marr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>0</td>
      <td>female</td>
      <td>21</td>
      <td>0</td>
      <td>0.707570</td>
      <td>35</td>
      <td>2</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9</td>
      <td>0</td>
      <td>female</td>
      <td>42</td>
      <td>0</td>
      <td>0.694605</td>
      <td>57</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>0</td>
      <td>male</td>
      <td>1</td>
      <td>0</td>
      <td>0.824126</td>
      <td>19</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12</td>
      <td>0</td>
      <td>male</td>
      <td>4</td>
      <td>0</td>
      <td>0.602060</td>
      <td>22</td>
      <td>3</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12</td>
      <td>0</td>
      <td>male</td>
      <td>17</td>
      <td>0</td>
      <td>0.875061</td>
      <td>35</td>
      <td>3</td>
      <td>6</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>529</th>
      <td>18</td>
      <td>0</td>
      <td>male</td>
      <td>5</td>
      <td>0</td>
      <td>1.055378</td>
      <td>29</td>
      <td>3</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>530</th>
      <td>12</td>
      <td>0</td>
      <td>female</td>
      <td>33</td>
      <td>0</td>
      <td>0.785330</td>
      <td>51</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>531</th>
      <td>17</td>
      <td>0</td>
      <td>female</td>
      <td>25</td>
      <td>1</td>
      <td>1.366423</td>
      <td>48</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>532</th>
      <td>12</td>
      <td>1</td>
      <td>male</td>
      <td>13</td>
      <td>1</td>
      <td>1.298416</td>
      <td>31</td>
      <td>3</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>533</th>
      <td>16</td>
      <td>0</td>
      <td>male</td>
      <td>33</td>
      <td>0</td>
      <td>1.186956</td>
      <td>55</td>
      <td>3</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>534 rows × 11 columns</p>
</div></div></div>
</div>
<section id="pairplot-scatter-matrices">
<h3>Pairplot: scatter matrices<a class="headerlink" href="#pairplot-scatter-matrices" title="Link to this heading">#</a></h3>
<p>We can easily have an intuition on the interactions between continuous
variables using <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.pairplot.html#seaborn.pairplot" title="(in seaborn v0.13.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">seaborn.pairplot()</span></code></a> to display a scatter matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seaborn</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;wage&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;reg&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2dd381a6e7e543fc4d11d2cc452fb3d29ab9fd958c68b1e39e92f8476e861352.png" src="../../_images/2dd381a6e7e543fc4d11d2cc452fb3d29ab9fd958c68b1e39e92f8476e861352.png" />
</div>
</div>
<p>Categorical variables can be plotted as the hue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seaborn</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;wage&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">],</span>
                 <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;reg&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;sex&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a1ca34a99f97c035b7c033e8edaf129a9890c670adf422fa603709ddf4230fff.png" src="../../_images/a1ca34a99f97c035b7c033e8edaf129a9890c670adf422fa603709ddf4230fff.png" />
</div>
</div>
<aside class="topic">
<p class="topic-title"><strong>Look and feel and matplotlib settings</strong></p>
<p>Seaborn changes the default of matplotlib figures to achieve a more
“modern”, “excel-like” look. It does that upon import. You can reset
the default using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>
</pre></div>
</div>
<div class="dropdown admonition note">
<p class="admonition-title">Note</p>
<p>To switch back to seaborn settings, or understand better styling in
seaborn, see the <a class="reference external" href="https://seaborn.pydata.org/tutorial/aesthetics.html">relevant section of the seaborn documentation</a>.</p>
</div>
</aside>
</section>
<section id="lmplot-plotting-a-univariate-regression">
<h3>lmplot: plotting a univariate regression<a class="headerlink" href="#lmplot-plotting-a-univariate-regression" title="Link to this heading">#</a></h3>
<p>A regression capturing the relation between one variable and another, eg
wage, and education, can be plotted using <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.lmplot.html#seaborn.lmplot" title="(in seaborn v0.13.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">seaborn.lmplot()</span></code></a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seaborn</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;wage&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3756a5500aa408f2c3cec9e8f06c475bb617033181cc47ff0097d7230917bc7c.png" src="../../_images/3756a5500aa408f2c3cec9e8f06c475bb617033181cc47ff0097d7230917bc7c.png" />
</div>
</div>
<aside class="topic">
<p class="topic-title"><strong>Robust regression</strong></p>
<div class="dropdown admonition note">
<p class="admonition-title">Note</p>
<p>Given that, in the above plot, there seems to be a couple of data
points that are outside of the main cloud to the right, they might be
outliers, not representative of the population, but driving the
regression.</p>
</div>
<p>To compute a regression that is less sensitive to outliers, one must use
a <a class="reference external" href="https://en.wikipedia.org/wiki/Robust_statistics">robust model</a>. This is
done in seaborn using <code class="docutils literal notranslate"><span class="pre">robust=True</span></code> in the plotting functions, or in
statsmodels by replacing the use of the OLS by a “Robust Linear Model”,
<a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.formula.api.rlm.html#statsmodels.formula.api.rlm" title="(in statsmodels 0.14.4 v0.14.4)"><code class="xref py py-func docutils literal notranslate"><span class="pre">statsmodels.formula.api.rlm()</span></code></a>. ::::</p>
</aside>
</section>
</section>
<section id="testing-for-interactions">
<h2>Testing for interactions<a class="headerlink" href="#testing-for-interactions" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seaborn</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;wage&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;education&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;sex&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b4a58ea69be2deecf350c7758b8c348c8dbebe2e8087d3ea62dbd6ab131bc3b5.png" src="../../_images/b4a58ea69be2deecf350c7758b8c348c8dbebe2e8087d3ea62dbd6ab131bc3b5.png" />
</div>
</div>
<p>We can first ask do <code class="docutils literal notranslate"><span class="pre">education</span></code> and <code class="docutils literal notranslate"><span class="pre">sex</span></code> separately contribute to <code class="docutils literal notranslate"><span class="pre">wage</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;wage ~ education + sex&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>wage</td>       <th>  R-squared:         </th> <td>   0.193</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.190</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   63.42</td>
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 29 Sep 2025</td> <th>  Prob (F-statistic):</th> <td>2.01e-25</td>
</tr>
<tr>
  <th>Time:</th>                 <td>12:28:44</td>     <th>  Log-Likelihood:    </th> <td>  86.654</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   534</td>      <th>  AIC:               </th> <td>  -167.3</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   531</td>      <th>  BIC:               </th> <td>  -154.5</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     2</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>   <td>    0.4053</td> <td>    0.046</td> <td>    8.732</td> <td> 0.000</td> <td>    0.314</td> <td>    0.496</td>
</tr>
<tr>
  <th>sex[T.male]</th> <td>    0.1008</td> <td>    0.018</td> <td>    5.625</td> <td> 0.000</td> <td>    0.066</td> <td>    0.136</td>
</tr>
<tr>
  <th>education</th>   <td>    0.0334</td> <td>    0.003</td> <td>    9.768</td> <td> 0.000</td> <td>    0.027</td> <td>    0.040</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 4.675</td> <th>  Durbin-Watson:     </th> <td>   1.792</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.097</td> <th>  Jarque-Bera (JB):  </th> <td>   4.876</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.147</td> <th>  Prob(JB):          </th> <td>  0.0873</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.365</td> <th>  Cond. No.          </th> <td>    69.7</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<p>Our next question is — do wages <em>increase more</em> with education for males than
females?</p>
<div class="dropdown admonition note">
<p class="admonition-title">Note</p>
<p>The plot above is made of two different fits. We need to formulate a
single model that tests for a variance of slope across the two
populations. This is done via an <a class="reference external" href="https://www.statsmodels.org/devel/example_formulas.html#multiplicative-interactions">“interaction”</a>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;wage ~ education + sex + education * sex&#39;</span><span class="p">,</span>
                 <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>wage</td>       <th>  R-squared:         </th> <td>   0.198</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.194</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   43.72</td>
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 29 Sep 2025</td> <th>  Prob (F-statistic):</th> <td>2.94e-25</td>
</tr>
<tr>
  <th>Time:</th>                 <td>12:28:44</td>     <th>  Log-Likelihood:    </th> <td>  88.503</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   534</td>      <th>  AIC:               </th> <td>  -169.0</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   530</td>      <th>  BIC:               </th> <td>  -151.9</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
            <td></td>               <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>             <td>    0.2998</td> <td>    0.072</td> <td>    4.173</td> <td> 0.000</td> <td>    0.159</td> <td>    0.441</td>
</tr>
<tr>
  <th>sex[T.male]</th>           <td>    0.2750</td> <td>    0.093</td> <td>    2.972</td> <td> 0.003</td> <td>    0.093</td> <td>    0.457</td>
</tr>
<tr>
  <th>education</th>             <td>    0.0415</td> <td>    0.005</td> <td>    7.647</td> <td> 0.000</td> <td>    0.031</td> <td>    0.052</td>
</tr>
<tr>
  <th>education:sex[T.male]</th> <td>   -0.0134</td> <td>    0.007</td> <td>   -1.919</td> <td> 0.056</td> <td>   -0.027</td> <td>    0.000</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 4.838</td> <th>  Durbin-Watson:     </th> <td>   1.825</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.089</td> <th>  Jarque-Bera (JB):  </th> <td>   5.000</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.156</td> <th>  Prob(JB):          </th> <td>  0.0821</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.356</td> <th>  Cond. No.          </th> <td>    194.</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<p>Can we conclude that education benefits males more than females?</p>
<div class="admonition-take-home-messages admonition">
<p class="admonition-title">Take home messages</p>
<ul class="simple">
<li><p>Hypothesis testing and p-values give you the <strong>significance</strong> of an
effect / difference.</p></li>
<li><p><strong>Formulas</strong> (with categorical variables) enable you to express rich
links in your data.</p></li>
<li><p><strong>Visualizing</strong> your data and fitting simple models give insight into the
data.</p></li>
<li><p><strong>Conditionning</strong> (adding factors that can explain all or part of
the variation) is an important modeling aspect that changes the
interpretation.</p></li>
</ul>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./packages/statistics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Packages and applications</p>
      </div>
    </a>
    <a class="right-next"
       href="../sympy.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Sympy : Symbolic Mathematics in Python</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-representation-and-interaction">Data representation and interaction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-as-a-table">Data as a table</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-pandas-data-frame">The pandas data-frame</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-dataframes-reading-data-files-or-converting-arrays">Creating dataframes: reading data files or converting arrays</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulating-data">Manipulating data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-data">Plotting data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-testing-comparing-two-groups">Hypothesis testing: comparing two groups</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#student-s-t-test-the-simplest-statistical-test">Student’s t-test: the simplest statistical test</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#one-sample-tests-testing-the-value-of-a-population-mean">One-sample tests: testing the value of a population mean</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#two-sample-t-test-testing-for-difference-across-populations">Two-sample t-test: testing for difference across populations</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#paired-tests-repeated-measurements-on-the-same-individuals">Paired tests: repeated measurements on the same individuals</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-models-multiple-factors-and-analysis-of-variance">Linear models, multiple factors, and analysis of variance</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#formulas-to-specify-statistical-models-in-python">“formulas” to specify statistical models in Python</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-linear-regression">A simple linear regression</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-variables-comparing-groups-or-multiple-categories">Categorical variables: comparing groups or multiple categories</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#link-to-t-tests-between-different-fsiq-and-piq">Link to t-tests between different FSIQ and PIQ</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-regression-including-multiple-factors">Multiple Regression: including multiple factors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#post-hoc-hypothesis-testing-analysis-of-variance-anova">Post-hoc hypothesis testing: analysis of variance (ANOVA)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-visualization-seaborn-for-statistical-exploration">More visualization: Seaborn for statistical exploration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pairplot-scatter-matrices">Pairplot: scatter matrices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lmplot-plotting-a-univariate-regression">lmplot: plotting a univariate regression</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-for-interactions">Testing for interactions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Scientific Python developers
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>